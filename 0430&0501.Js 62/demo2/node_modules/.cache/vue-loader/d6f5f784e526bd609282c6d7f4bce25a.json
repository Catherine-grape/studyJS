{"remainingRequest":"/Users/fivegl/Desktop/demo2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fivegl/Desktop/demo2/src/pages/Home/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fivegl/Desktop/demo2/src/pages/Home/index.vue","mtime":1619835632839},{"path":"/Users/fivegl/Desktop/demo2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9oZWFkZXIiOwppbXBvcnQgc3dpcGVyIGZyb20gIi4uLy4uL2NvbXBvbmVudHMvc3dpcGVyIjsKaW1wb3J0IG5ld3NJdGVtIGZyb20gIi4vbmV3c2l0ZW0iOwppbXBvcnQgeyBsYXRlc3QsIGJlZm9yZSB9IGZyb20gIi4uLy4uL2FwaS9pbmRleCI7CgppbXBvcnQgeyBkZWxheSB9IGZyb20gIi4uLy4uL2Fzc2V0cy91dGlscyI7CmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRhdGU6ICIiLAogICAgICBuZXdzOiBbCiAgICAgICAgLyogewogICAgICAgICAgICAgICAgZGF0ZTonMjAyMTA0MzAnLAogICAgICAgICAgICAgICAgbGlzdDpbLi4uXQogICAgICAgICAgICB9ICovCiAgICAgIF0sCiAgICAgIHN3aXBlckRhdGE6IFtdLAogICAgICBmbGFnOiBmYWxzZSwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXREYXRhKCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgdGhpcy5nZXRNb3JlKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldERhdGEoKSB7CiAgICAgIGxhdGVzdCgpLnRoZW4oKHJlcykgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcywgNTIpOwogICAgICAgIGxldCB7IGRhdGUsIHN0b3JpZXMsIHRvcF9zdG9yaWVzIH0gPSByZXM7CiAgICAgICAgdGhpcy5kYXRlID0gZGF0ZTsKICAgICAgICB0aGlzLnN3aXBlckRhdGEgPSB0b3Bfc3RvcmllczsKICAgICAgICB0aGlzLm5ld3MucHVzaCh7IGRhdGU6IGRhdGUsIGxpc3Q6IHN0b3JpZXMgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldE1vcmUoKSB7CiAgICAgIGlmICh0aGlzLmZsYWcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbGV0IHJlYWxIID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwcCIpLm9mZnNldEhlaWdodCwKICAgICAgICB3aW5IID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCwKICAgICAgICB3aW5TID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKICAgICAgaWYgKHdpbkggKyB3aW5TICsgMTAwID49IHJlYWxIKSB7CiAgICAgICAgdGhpcy5mbGFnID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygxMTEpOwogICAgICAgICAgdGhpcy5nZXRCZWZvcmUoKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGdldEJlZm9yZSgpIHsKICAgICAgLyogIGJlZm9yZSh0aGlzLmRhdGUpLnRoZW4oKCk9PnsKICAgICAgICAgICAvL+W9k+WJjeWHveaVsOmHjOeahOS7o+eggeS8muetieWIsHByb21pc2XnmoTlrp7kvovlj5jmiJDmiJDlip/mgIHku6XlkI7miY3kvJrmiafooYwKICAgICAgIH0pICovCiAgICAgIC8qIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLHJlamVjdCk9PnsKICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57CiAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICB9LDMwMDApCiAgICAgICB9KSAqLwogICAgICBhd2FpdCBkZWxheSgpOwogICAgICBsZXQgcmVzID0gYXdhaXQgYmVmb3JlKHRoaXMuZGF0ZSk7CiAgICAgIC8vICAgYXdhaXTkuIvpnaLnmoTku6PnoIHlt7Lnu4/lj5jmiJDkuoblvILmraXnmoTvvIzku4DkuYjml7blgJnkuIrovrnnmoTlrp7kvovlj5jmiJDmiJDlip/mgIHvvIzku4DkuYjml7blgJnkuIvpnaLnmoTku6PnoIHmiY3kvJrmiafooYwKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgLy8g5q+P5LiA5qyh6K+35rGC55qE5pWw5o2u6YO95pivMTDmnaHvvIzlgYforr7lkI7lj7DmlbDmja7lupPkuIDlhbHmnIkxMDLmnaHmlbDmja7vvIzlkrHku6zmnIDlpJrlj6/ku6Xor7fmsYIxMeasoSzlpoLmnpzlvZPliY3or7fmsYLnmoTmlbDmja7nmoRsZW5ndGjlsI/kuo4xMOadoe+8jOmCo+ivtOaYjuW3sue7j+aYr+acgOWQjuS4gOasoeivt+axguS6hu+8jOS9oOWwseWPr+S7peiuqWZsYWfmsLjov5zmlLnkuLp0cnVl77yMIOiuqWlzRW5k5rC46L+c5pS55Li6dHJ1ZSAgICAsaXNFbmQKCiAgICAgIGxldCB7IGRhdGUsIHN0b3JpZXN9ID0gcmVzOwogICAgICB0aGlzLmRhdGUgPSBkYXRlOyAvLycyMDIxMDQyOScgJzIwMjEwNDI4JwogICAgICB0aGlzLmZsYWcgPSBmYWxzZTsKICAgICAgdGhpcy5uZXdzLnB1c2goewogICAgICAgIGRhdGU6IGRhdGUsCiAgICAgICAgbGlzdDogc3RvcmllcywKICAgICAgfSk7CgoKLyogdGhpcy5pc0VuZD1pc0VuZDsKICAgICAgaWYoIWlzRW5kKXsvL2lzRW5k5ZKM5ZCO5Y+w5ZWG6YeP5bey57uP5rKh5pyJ5pWw5o2u55qE5pe25YCZ5L2c5Li65Yik5patIGZhbHNl5bCx5Y+v5Lul57un57ut6K+35rGCCiAgICAgICAgdGhpcy5mbGFnID0gZmFsc2U7CiAgICAgIH0gKi8KCiAgICAgIC8qIGlmIChzdG9yaWVzLmxlbmd0aCA9PSAxMCkgewogICAgICAgIC8v5ZCO5Y+w5aaC5p6c5LiN57uZ5a2X5q615qCH6K+G55qE6K+d77yM6YCa6L+H5Yik5patbGVuZ3RoCiAgICAgICAgdGhpcy5mbGFnID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc0VuZCA9IHRydWU7CiAgICAgIH0KICovCiAgICAgIC8qIGxldCByZXMxPWF3YWl0IGJlZm9yZSh0aGlzLmRhdGUpOwogICAgY29uc29sZS5sb2cocmVzMSk7ICovCiAgICB9LAogIH0sCiAgY29tcG9uZW50czogewogICAgIm15LWhlYWRlciI6IEhlYWRlciwKICAgICJteS1zd2lwZXIiOiBzd2lwZXIsCiAgICAibXktbmV3c2l0ZW0iOiBuZXdzSXRlbSwKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/Home","sourcesContent":["<template>\n  <div class=\"home\">\n    <!-- 头部部分 -->\n    <my-header></my-header>\n\n    <!-- 轮播图部分 -->\n    <my-swiper :data=\"swiperData\"></my-swiper>\n\n    <!-- 新闻列表的部分 -->\n    <van-skeleton v-if=\"!news.length\" title :row=\"3\" />\n    <div class=\"news\">\n      <my-newsitem :key=\"index\" v-for=\"(item, index) in news\" :item=\"item\">\n      </my-newsitem>\n      <div v-show=\"flag\" style=\"height: 100px; background: lightblue\">\n        正在加载\n      </div>\n            <!-- <div v-show=\"isEnd\">已经加载完毕了</div> -->\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport Header from \"../../components/header\";\nimport swiper from \"../../components/swiper\";\nimport newsItem from \"./newsitem\";\nimport { latest, before } from \"../../api/index\";\n\nimport { delay } from \"../../assets/utils\";\nexport default {\n  props: {},\n  data() {\n    return {\n      date: \"\",\n      news: [\n        /* {\n                date:'20210430',\n                list:[...]\n            } */\n      ],\n      swiperData: [],\n      flag: false,\n    };\n  },\n  created() {\n    this.getData();\n    window.addEventListener(\"scroll\", this.getMore);\n  },\n  methods: {\n    getData() {\n      latest().then((res) => {\n        console.log(res, 52);\n        let { date, stories, top_stories } = res;\n        this.date = date;\n        this.swiperData = top_stories;\n        this.news.push({ date: date, list: stories });\n      });\n    },\n    getMore() {\n      if (this.flag) {\n        return;\n      }\n      let realH = document.getElementById(\"app\").offsetHeight,\n        winH = document.documentElement.clientHeight,\n        winS = document.documentElement.scrollTop;\n      if (winH + winS + 100 >= realH) {\n        this.flag = true;\n        console.log(111);\n          this.getBefore();\n      }\n    },\n    async getBefore() {\n      /*  before(this.date).then(()=>{\n           //当前函数里的代码会等到promise的实例变成成功态以后才会执行\n       }) */\n      /* await new Promise((resolve,reject)=>{\n           setTimeout(()=>{\n               resolve();\n           },3000)\n       }) */\n      await delay();\n      let res = await before(this.date);\n      //   await下面的代码已经变成了异步的，什么时候上边的实例变成成功态，什么时候下面的代码才会执行\n      console.log(res);\n      // 每一次请求的数据都是10条，假设后台数据库一共有102条数据，咱们最多可以请求11次,如果当前请求的数据的length小于10条，那说明已经是最后一次请求了，你就可以让flag永远改为true， 让isEnd永远改为true    ,isEnd\n\n      let { date, stories} = res;\n      this.date = date; //'20210429' '20210428'\n      this.flag = false;\n      this.news.push({\n        date: date,\n        list: stories,\n      });\n\n\n/* this.isEnd=isEnd;\n      if(!isEnd){//isEnd和后台商量已经没有数据的时候作为判断 false就可以继续请求\n        this.flag = false;\n      } */\n\n      /* if (stories.length == 10) {\n        //后台如果不给字段标识的话，通过判断length\n        this.flag = false;\n      } else {\n        this.isEnd = true;\n      }\n */\n      /* let res1=await before(this.date);\n    console.log(res1); */\n    },\n  },\n  components: {\n    \"my-header\": Header,\n    \"my-swiper\": swiper,\n    \"my-newsitem\": newsItem,\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.home {\n  //   background: lightpink;\n  width: 100%;\n  height: 100%;\n  .news {\n    padding-bottom: 10vh;\n  }\n}\n</style>\n\n"]}]}