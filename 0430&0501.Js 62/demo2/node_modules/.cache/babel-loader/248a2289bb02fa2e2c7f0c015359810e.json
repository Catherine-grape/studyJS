{"remainingRequest":"/Users/fivegl/Desktop/demo2/node_modules/babel-loader/lib/index.js!/Users/fivegl/Desktop/demo2/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/fivegl/Desktop/demo2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fivegl/Desktop/demo2/src/pages/Home/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fivegl/Desktop/demo2/src/pages/Home/index.vue","mtime":1619835632839},{"path":"/Users/fivegl/Desktop/demo2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL2ZpdmVnbC9EZXNrdG9wL2RlbW8yL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEhlYWRlciBmcm9tICIuLi8uLi9jb21wb25lbnRzL2hlYWRlciI7CmltcG9ydCBzd2lwZXIgZnJvbSAiLi4vLi4vY29tcG9uZW50cy9zd2lwZXIiOwppbXBvcnQgbmV3c0l0ZW0gZnJvbSAiLi9uZXdzaXRlbSI7CmltcG9ydCB7IGxhdGVzdCwgYmVmb3JlIH0gZnJvbSAiLi4vLi4vYXBpL2luZGV4IjsKaW1wb3J0IHsgZGVsYXkgfSBmcm9tICIuLi8uLi9hc3NldHMvdXRpbHMiOwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRlOiAiIiwKICAgICAgbmV3czogWwogICAgICAgIC8qIHsKICAgICAgICAgICAgICAgIGRhdGU6JzIwMjEwNDMwJywKICAgICAgICAgICAgICAgIGxpc3Q6Wy4uLl0KICAgICAgICAgICAgfSAqLwogICAgICBdLAogICAgICBzd2lwZXJEYXRhOiBbXSwKICAgICAgZmxhZzogZmFsc2UKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5nZXREYXRhKCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgdGhpcy5nZXRNb3JlKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldERhdGE6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBsYXRlc3QoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMsIDUyKTsKICAgICAgICB2YXIgZGF0ZSA9IHJlcy5kYXRlLAogICAgICAgICAgICBzdG9yaWVzID0gcmVzLnN0b3JpZXMsCiAgICAgICAgICAgIHRvcF9zdG9yaWVzID0gcmVzLnRvcF9zdG9yaWVzOwogICAgICAgIF90aGlzLmRhdGUgPSBkYXRlOwogICAgICAgIF90aGlzLnN3aXBlckRhdGEgPSB0b3Bfc3RvcmllczsKCiAgICAgICAgX3RoaXMubmV3cy5wdXNoKHsKICAgICAgICAgIGRhdGU6IGRhdGUsCiAgICAgICAgICBsaXN0OiBzdG9yaWVzCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldE1vcmU6IGZ1bmN0aW9uIGdldE1vcmUoKSB7CiAgICAgIGlmICh0aGlzLmZsYWcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciByZWFsSCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhcHAiKS5vZmZzZXRIZWlnaHQsCiAgICAgICAgICB3aW5IID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCwKICAgICAgICAgIHdpblMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wOwoKICAgICAgaWYgKHdpbkggKyB3aW5TICsgMTAwID49IHJlYWxIKSB7CiAgICAgICAgdGhpcy5mbGFnID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygxMTEpOwogICAgICAgIHRoaXMuZ2V0QmVmb3JlKCk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRCZWZvcmU6IGZ1bmN0aW9uIGdldEJlZm9yZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciByZXMsIGRhdGUsIHN0b3JpZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gZGVsYXkoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gYmVmb3JlKF90aGlzMi5kYXRlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIC8vICAgYXdhaXTkuIvpnaLnmoTku6PnoIHlt7Lnu4/lj5jmiJDkuoblvILmraXnmoTvvIzku4DkuYjml7blgJnkuIrovrnnmoTlrp7kvovlj5jmiJDmiJDlip/mgIHvvIzku4DkuYjml7blgJnkuIvpnaLnmoTku6PnoIHmiY3kvJrmiafooYwKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7IC8vIOavj+S4gOasoeivt+axgueahOaVsOaNrumDveaYrzEw5p2h77yM5YGH6K6+5ZCO5Y+w5pWw5o2u5bqT5LiA5YWx5pyJMTAy5p2h5pWw5o2u77yM5ZKx5Lus5pyA5aSa5Y+v5Lul6K+35rGCMTHmrKEs5aaC5p6c5b2T5YmN6K+35rGC55qE5pWw5o2u55qEbGVuZ3Ro5bCP5LqOMTDmnaHvvIzpgqPor7TmmI7lt7Lnu4/mmK/mnIDlkI7kuIDmrKHor7fmsYLkuobvvIzkvaDlsLHlj6/ku6XorqlmbGFn5rC46L+c5pS55Li6dHJ1Ze+8jCDorqlpc0VuZOawuOi/nOaUueS4unRydWUgICAgLGlzRW5kCgogICAgICAgICAgICAgICAgZGF0ZSA9IHJlcy5kYXRlLCBzdG9yaWVzID0gcmVzLnN0b3JpZXM7CiAgICAgICAgICAgICAgICBfdGhpczIuZGF0ZSA9IGRhdGU7IC8vJzIwMjEwNDI5JyAnMjAyMTA0MjgnCgogICAgICAgICAgICAgICAgX3RoaXMyLmZsYWcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBfdGhpczIubmV3cy5wdXNoKHsKICAgICAgICAgICAgICAgICAgZGF0ZTogZGF0ZSwKICAgICAgICAgICAgICAgICAgbGlzdDogc3RvcmllcwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAvKiB0aGlzLmlzRW5kPWlzRW5kOwogICAgICAgICAgICAgICAgICAgICAgaWYoIWlzRW5kKXsvL2lzRW5k5ZKM5ZCO5Y+w5ZWG6YeP5bey57uP5rKh5pyJ5pWw5o2u55qE5pe25YCZ5L2c5Li65Yik5patIGZhbHNl5bCx5Y+v5Lul57un57ut6K+35rGCCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmxhZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgfSAqLwoKICAgICAgICAgICAgICAgIC8qIGlmIChzdG9yaWVzLmxlbmd0aCA9PSAxMCkgewogICAgICAgICAgICAgICAgICAvL+WQjuWPsOWmguaenOS4jee7meWtl+auteagh+ivhueahOivne+8jOmAmui/h+WIpOaWrWxlbmd0aAogICAgICAgICAgICAgICAgICB0aGlzLmZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuaXNFbmQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKi8KCiAgICAgICAgICAgICAgICAvKiBsZXQgcmVzMT1hd2FpdCBiZWZvcmUodGhpcy5kYXRlKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlczEpOyAqLwoKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgICJteS1oZWFkZXIiOiBIZWFkZXIsCiAgICAibXktc3dpcGVyIjogc3dpcGVyLAogICAgIm15LW5ld3NpdGVtIjogbmV3c0l0ZW0KICB9Cn07"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAuBA,OAAA,MAAA,MAAA,yBAAA;AACA,OAAA,MAAA,MAAA,yBAAA;AACA,OAAA,QAAA,MAAA,YAAA;AACA,SAAA,MAAA,EAAA,MAAA,QAAA,iBAAA;AAEA,SAAA,KAAA,QAAA,oBAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA,EADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,EADA;AAEA,MAAA,IAAA,EAAA;AACA;;;;AADA,OAFA;AAQA,MAAA,UAAA,EAAA,EARA;AASA,MAAA,IAAA,EAAA;AATA,KAAA;AAWA,GAdA;AAeA,EAAA,OAfA,qBAeA;AACA,SAAA,OAAA;AACA,IAAA,MAAA,CAAA,gBAAA,CAAA,QAAA,EAAA,KAAA,OAAA;AACA,GAlBA;AAmBA,EAAA,OAAA,EAAA;AACA,IAAA,OADA,qBACA;AAAA;;AACA,MAAA,MAAA,GAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA,EAAA,EAAA;AADA,YAEA,IAFA,GAEA,GAFA,CAEA,IAFA;AAAA,YAEA,OAFA,GAEA,GAFA,CAEA,OAFA;AAAA,YAEA,WAFA,GAEA,GAFA,CAEA,WAFA;AAGA,QAAA,KAAA,CAAA,IAAA,GAAA,IAAA;AACA,QAAA,KAAA,CAAA,UAAA,GAAA,WAAA;;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AAAA,UAAA,IAAA,EAAA,IAAA;AAAA,UAAA,IAAA,EAAA;AAAA,SAAA;AACA,OANA;AAOA,KATA;AAUA,IAAA,OAVA,qBAUA;AACA,UAAA,KAAA,IAAA,EAAA;AACA;AACA;;AACA,UAAA,KAAA,GAAA,QAAA,CAAA,cAAA,CAAA,KAAA,EAAA,YAAA;AAAA,UACA,IAAA,GAAA,QAAA,CAAA,eAAA,CAAA,YADA;AAAA,UAEA,IAAA,GAAA,QAAA,CAAA,eAAA,CAAA,SAFA;;AAGA,UAAA,IAAA,GAAA,IAAA,GAAA,GAAA,IAAA,KAAA,EAAA;AACA,aAAA,IAAA,GAAA,IAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,aAAA,SAAA;AACA;AACA,KAtBA;AAuBA,IAAA,SAvBA,uBAuBA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBASA,KAAA,EATA;;AAAA;AAAA;AAAA,uBAUA,MAAA,CAAA,MAAA,CAAA,IAAA,CAVA;;AAAA;AAUA,gBAAA,GAVA;AAWA;AACA,gBAAA,OAAA,CAAA,GAAA,CAAA,GAAA,EAZA,CAaA;;AAEA,gBAAA,IAfA,GAeA,GAfA,CAeA,IAfA,EAeA,OAfA,GAeA,GAfA,CAeA,OAfA;AAgBA,gBAAA,MAAA,CAAA,IAAA,GAAA,IAAA,CAhBA,CAgBA;;AACA,gBAAA,MAAA,CAAA,IAAA,GAAA,KAAA;;AACA,gBAAA,MAAA,CAAA,IAAA,CAAA,IAAA,CAAA;AACA,kBAAA,IAAA,EAAA,IADA;AAEA,kBAAA,IAAA,EAAA;AAFA,iBAAA;AAMA;;;;;AAKA;;;;;;;;AAOA;;;;AApCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsCA;AA7DA,GAnBA;AAkFA,EAAA,UAAA,EAAA;AACA,iBAAA,MADA;AAEA,iBAAA,MAFA;AAGA,mBAAA;AAHA;AAlFA,CAAA","sourcesContent":["<template>\n  <div class=\"home\">\n    <!-- 头部部分 -->\n    <my-header></my-header>\n\n    <!-- 轮播图部分 -->\n    <my-swiper :data=\"swiperData\"></my-swiper>\n\n    <!-- 新闻列表的部分 -->\n    <van-skeleton v-if=\"!news.length\" title :row=\"3\" />\n    <div class=\"news\">\n      <my-newsitem :key=\"index\" v-for=\"(item, index) in news\" :item=\"item\">\n      </my-newsitem>\n      <div v-show=\"flag\" style=\"height: 100px; background: lightblue\">\n        正在加载\n      </div>\n            <!-- <div v-show=\"isEnd\">已经加载完毕了</div> -->\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport Header from \"../../components/header\";\nimport swiper from \"../../components/swiper\";\nimport newsItem from \"./newsitem\";\nimport { latest, before } from \"../../api/index\";\n\nimport { delay } from \"../../assets/utils\";\nexport default {\n  props: {},\n  data() {\n    return {\n      date: \"\",\n      news: [\n        /* {\n                date:'20210430',\n                list:[...]\n            } */\n      ],\n      swiperData: [],\n      flag: false,\n    };\n  },\n  created() {\n    this.getData();\n    window.addEventListener(\"scroll\", this.getMore);\n  },\n  methods: {\n    getData() {\n      latest().then((res) => {\n        console.log(res, 52);\n        let { date, stories, top_stories } = res;\n        this.date = date;\n        this.swiperData = top_stories;\n        this.news.push({ date: date, list: stories });\n      });\n    },\n    getMore() {\n      if (this.flag) {\n        return;\n      }\n      let realH = document.getElementById(\"app\").offsetHeight,\n        winH = document.documentElement.clientHeight,\n        winS = document.documentElement.scrollTop;\n      if (winH + winS + 100 >= realH) {\n        this.flag = true;\n        console.log(111);\n          this.getBefore();\n      }\n    },\n    async getBefore() {\n      /*  before(this.date).then(()=>{\n           //当前函数里的代码会等到promise的实例变成成功态以后才会执行\n       }) */\n      /* await new Promise((resolve,reject)=>{\n           setTimeout(()=>{\n               resolve();\n           },3000)\n       }) */\n      await delay();\n      let res = await before(this.date);\n      //   await下面的代码已经变成了异步的，什么时候上边的实例变成成功态，什么时候下面的代码才会执行\n      console.log(res);\n      // 每一次请求的数据都是10条，假设后台数据库一共有102条数据，咱们最多可以请求11次,如果当前请求的数据的length小于10条，那说明已经是最后一次请求了，你就可以让flag永远改为true， 让isEnd永远改为true    ,isEnd\n\n      let { date, stories} = res;\n      this.date = date; //'20210429' '20210428'\n      this.flag = false;\n      this.news.push({\n        date: date,\n        list: stories,\n      });\n\n\n/* this.isEnd=isEnd;\n      if(!isEnd){//isEnd和后台商量已经没有数据的时候作为判断 false就可以继续请求\n        this.flag = false;\n      } */\n\n      /* if (stories.length == 10) {\n        //后台如果不给字段标识的话，通过判断length\n        this.flag = false;\n      } else {\n        this.isEnd = true;\n      }\n */\n      /* let res1=await before(this.date);\n    console.log(res1); */\n    },\n  },\n  components: {\n    \"my-header\": Header,\n    \"my-swiper\": swiper,\n    \"my-newsitem\": newsItem,\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.home {\n  //   background: lightpink;\n  width: 100%;\n  height: 100%;\n  .news {\n    padding-bottom: 10vh;\n  }\n}\n</style>\n\n"],"sourceRoot":"src/pages/Home"}]}