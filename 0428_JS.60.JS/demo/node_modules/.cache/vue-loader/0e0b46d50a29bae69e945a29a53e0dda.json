{"remainingRequest":"/Users/fivegl/Desktop/demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fivegl/Desktop/demo/src/pages/customer/customerAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fivegl/Desktop/demo/src/pages/customer/customerAdd.vue","mtime":1619684890643},{"path":"/Users/fivegl/Desktop/demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fivegl/Desktop/demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {addCustomer, queryCustomerInfo,updateCustomer} from '../../api/main'\nvar validatePass2 = (rule, value, callback) => {\n  // 此函数是用来进行自定义校验的，当不校验通过之后，就调用callback并且给他传递一个new Error('xxxxxx')  ,  如果通过就直接执行callback()\n  let reg = /^1[3-8]\\d{9}$/;\n  if (!reg.test(value)) {\n    callback(new Error(\"手机号格式不对\"));\n  } else {\n    callback();\n  }\n};\nexport default {\n  data() {\n    return {\n      form: {\n        name: \"\",\n        sex: 0,\n        email: \"\",\n        phone: \"\",\n        QQ: \"\",\n        weixin: \"\",\n        type:'重点客户',\n        address:''\n      },\n      rules: {\n        phone: [\n          { required: true, message: \"请输入输入电话\", trigger: \"blur\" },\n          { validator: validatePass2, trigger: \"blur\" },\n        ],\n      },\n    };\n  },\n  created(){\n    //   console.log(this.$route.query);\n    let {id}=this.$route.query;\n    // 如果当前的id有值，说明是从点击编辑按钮哪里过来的，这时候去请求客户详细信息，并且渲染到页面。如果没有id那说明是点击新增客户按钮进来的，这时候不需要请求客户信息。\n    if(id || id==0){\n        queryCustomerInfo({customId:id}).then((result)=>{\n            let {code,data} =result;\n            if(code==0){\n                let {name,sex,email,weixin,QQ,phone,type,address}=data;\n                this.form={name,sex,email,weixin,QQ,phone,type,address}\n            }\n        })\n    }\n  },\n  methods:{\n    submit(){\n      this.$refs.form.validate((valid) => {\n          if (!valid) {\n            this.$message.error('请按规则填写表单');\n\n            return\n          } \n        //   发送新增的接口请求\n        // 或者修改的接口\nlet {id}=this.$route.query;\n          let {form}=this;\n          if(id||id==0){\n              updateCustomer({\n                  customerId:id,\n                  ...form\n              }).then((result)=>{\n                  let {code}=result;\n                  if(code==0){\n                      this.$alert('恭喜您修改成功',{\n                          callback:()=>{\n                              this.$router.push({\n                                  path:'/customer/list',\n                                  query:{type:'my'}\n                              })\n                          }\n                      })\n                  }\n              });\n              return;\n          }\n          addCustomer(form).then((result)=>{\n              let {code}=result;\n              if(code==0){\n                  this.$alert('恭喜您，新增成功',{\n                      callback:()=>{\n                          this.$router.push({\n                              path:'/customer/list',\n                              query:{type:'my'}\n                          })\n                      }\n                      \n                  })\n                  \n              }\n          })\n          console.log('正常提交');\n        });\n    },\n    reset(){\n       this.$refs.form.resetFields();\n    }\n  }\n};\n",{"version":3,"sources":["customerAdd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"customerAdd.vue","sourceRoot":"src/pages/customer","sourcesContent":["<template>\n  <div>\n    <h2>我是新增页面</h2>\n    <el-form ref=\"form\" :model=\"form\" label-width=\"80px\" :rules=\"rules\">\n      <el-form-item label=\"客户名\" prop=\"name\">\n        <el-input v-model=\"form.name\" ></el-input>\n      </el-form-item>\n      <el-form-item label=\"性别\" prop=\"sex\">\n        <el-radio-group v-model=\"form.sex\">\n          <el-radio :label=\"0\">男</el-radio>\n          <el-radio :label=\"1\">女</el-radio>\n        </el-radio-group>\n      </el-form-item>\n      <el-form-item label=\"邮箱\" prop=\"email\">\n        <el-input v-model=\"form.email\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"电话\" prop=\"phone\">\n        <el-input v-model=\"form.phone\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"QQ\" prop=\"QQ\">\n        <el-input v-model=\"form.QQ\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"weixin\" prop=\"weixin\">\n        <el-input v-model=\"form.weixin\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"地址\" prop=\"address\">\n        <el-input type=\"textarea\" v-model=\"form.address\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"活动区域\" prop=\"type\">\n        <el-select v-model=\"form.type\" placeholder=\"请输入活动类型\">\n          <el-option label=\"重点客户\" value=\"重点客户\"></el-option>\n          <el-option label=\"放弃客户\" value=\"放弃客户\"></el-option>\n          <el-option label=\"一般客户\" value=\"一般客户\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"submit\">立即创建</el-button>\n        <el-button @click=\"reset\">重置</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n<script>\nimport {addCustomer, queryCustomerInfo,updateCustomer} from '../../api/main'\nvar validatePass2 = (rule, value, callback) => {\n  // 此函数是用来进行自定义校验的，当不校验通过之后，就调用callback并且给他传递一个new Error('xxxxxx')  ,  如果通过就直接执行callback()\n  let reg = /^1[3-8]\\d{9}$/;\n  if (!reg.test(value)) {\n    callback(new Error(\"手机号格式不对\"));\n  } else {\n    callback();\n  }\n};\nexport default {\n  data() {\n    return {\n      form: {\n        name: \"\",\n        sex: 0,\n        email: \"\",\n        phone: \"\",\n        QQ: \"\",\n        weixin: \"\",\n        type:'重点客户',\n        address:''\n      },\n      rules: {\n        phone: [\n          { required: true, message: \"请输入输入电话\", trigger: \"blur\" },\n          { validator: validatePass2, trigger: \"blur\" },\n        ],\n      },\n    };\n  },\n  created(){\n    //   console.log(this.$route.query);\n    let {id}=this.$route.query;\n    // 如果当前的id有值，说明是从点击编辑按钮哪里过来的，这时候去请求客户详细信息，并且渲染到页面。如果没有id那说明是点击新增客户按钮进来的，这时候不需要请求客户信息。\n    if(id || id==0){\n        queryCustomerInfo({customId:id}).then((result)=>{\n            let {code,data} =result;\n            if(code==0){\n                let {name,sex,email,weixin,QQ,phone,type,address}=data;\n                this.form={name,sex,email,weixin,QQ,phone,type,address}\n            }\n        })\n    }\n  },\n  methods:{\n    submit(){\n      this.$refs.form.validate((valid) => {\n          if (!valid) {\n            this.$message.error('请按规则填写表单');\n\n            return\n          } \n        //   发送新增的接口请求\n        // 或者修改的接口\nlet {id}=this.$route.query;\n          let {form}=this;\n          if(id||id==0){\n              updateCustomer({\n                  customerId:id,\n                  ...form\n              }).then((result)=>{\n                  let {code}=result;\n                  if(code==0){\n                      this.$alert('恭喜您修改成功',{\n                          callback:()=>{\n                              this.$router.push({\n                                  path:'/customer/list',\n                                  query:{type:'my'}\n                              })\n                          }\n                      })\n                  }\n              });\n              return;\n          }\n          addCustomer(form).then((result)=>{\n              let {code}=result;\n              if(code==0){\n                  this.$alert('恭喜您，新增成功',{\n                      callback:()=>{\n                          this.$router.push({\n                              path:'/customer/list',\n                              query:{type:'my'}\n                          })\n                      }\n                      \n                  })\n                  \n              }\n          })\n          console.log('正常提交');\n        });\n    },\n    reset(){\n       this.$refs.form.resetFields();\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n</style>"]}]}